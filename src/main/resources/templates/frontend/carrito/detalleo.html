<!DOCTYPE html>
<html lang="en" xmlns:th="http://wwww.thymeleaf.org">
<head th:replace="recursos/navbar::head">
<meta charset="UTF-8"/>
<title>Art Academy</title>
</head>
<style>
.error{
color: red;
}
</style>
<body>
<!-- Navbar -->
<nav th:replace="recursos/navbar :: navbar">
</nav>
<!-- Navbar -->

<!--Main layout-->
<main class="mt-5 pt-4">
  <div class="container dark-grey-text mt-5">

    <!--Grid row-->
    <div class="row wow fadeIn">

      <!--Grid column-->
      <div class="col-md-6 mb-4">

		<div class="form-group text-center">
		<p class="lead font-weight-bold">Nombre de la Obra</p>
              <p th:text="${Obras.nombre}" style="font-size: 18px;"></p>
        </div> 
        
        
        
        <div class="form-group">
         
          <div class="col-md-8 col-lg-6 col-xl-9 ">
                    <!--Carousel Wrapper-->
                  <div id="carousel-thumb" class="carousel slide carousel-fade carousel-thumbnails" >
                    <!--Slides-->
                    <div class="carousel-inner" role="listbox">
                      <div class="carousel-item active" th:if="${Obras.rutaimagen_principal!=null}" >
                        <img height="320px" class="d-block w-100" th:if="${#strings.length(Obras.rutaimagen_principal)>0}" th:src="@{'/imagenes/'+${Obras.rutaimagen_principal}}"
                         >
                      </div>
                      <div class="carousel-item" th:if="${Obras.rutaimagen_2!=null}">
                        <img height="320px" class="d-block w-100" th:src="@{'/imagenes/'+${Obras.rutaimagen_2}}"
                          alt="Second slide">
                      </div>
                      <div class="carousel-item">
                        <img height="320px" class="d-block w-100" th:if="${#strings.length(Obras.rutaimagen_3)>0}" th:src="@{'/imagenes/'+${Obras.rutaimagen_3}}"
                          alt="Third slide">
                      </div>
                    </div>
                    <!--/.Slides-->
                    <!--Controls-->
                   
                    
                    <!--/.Controls-->
                    <ol class="carousel-indicators">
                      <li data-target="#carousel-thumb" th:if="${Obras.rutaimagen_principal!=null}" data-slide-to="0" class="active">
                        <img th:if="${#strings.length(Obras.rutaimagen_principal)>0}" th:src="@{'/imagenes/'+${Obras.rutaimagen_principal}}" width="100">
                      </li>
                      <li data-target="#carousel-thumb" data-slide-to="1" th:if="${Obras.rutaimagen_2>0}">
                        <img th:if="" th:src="@{'/imagenes/'+${Obras.rutaimagen_2}}" width="100">
                      </li>
                      <li data-target="#carousel-thumb" data-slide-to="2">
                        <img th:if="${#strings.length(Obras.rutaimagen_3)>0}" th:src="@{'/imagenes/'+${Obras.rutaimagen_3}}" width="100">
                      </li>
                    </ol>
                  </div>
                  <!--/.Carousel Wrapper-->
                    
                      </div>
        </div> 



      </div>
      <!--Grid column-->

      <!--Grid column-->
      <div class="col-md-6 mb-4">

        <!--Content-->
        <div class="p-4">
        

        <div class="form-group">
        <p class="lead font-weight-bold">Categorias</p>
        <p th:text="${Obras.categoria.nombrecategoria}"></p>
        </div>


	

		<div class="form-group">
        <p class="lead font-weight-bold">Descripción de la obra</p>
        <p th:text="${Obras.descripcion}"></p>
        </div>
                
                
		
         <form method="POST" id="formdetalle" th:action="@{/agregar_carrito}" class="d-flex justify-content-left">
            
            
      	<div class="form-group">
        <p class="lead font-weight-bold">Tamaño</p>
        
        <select name="caracteristica" id="caracteristica" onchange="buscar_caracteristica(this)" class="form-control select2" style="width: 100%;">
        <option value="">Seleccione tamaño</option>
        <th:block th:each="carac:${caracteristicas}">
        <option th:value="${carac.id}" th:text="${carac.size}"></option>
        </th:block>
        </select>
        <p id="precio" class="py-4"></p>
        <p class="lead font-weight-bold">Stock</p>
            <input name="cantidad" id="txtCantidad" onchange="validad_stock()" type="number" value="1" aria-label="Search" class="form-control" style="width: 100%">
         <button id="btnGuardar" class="btn btn-default btn-md my-4 " type="submit" >Añadir al carrito
              <i class="fas fa-shopping-cart ml-1"></i>
            </button>  
            <button class="btn btn-danger btn-md my-0 p" type="submit">
            <i class="fas fa-angle-left"></i> Volver 
             
            </button>
        </div>
       
           

          </form>

        </div>
        <!--Content-->

      </div>
      <!--Grid column-->

    </div>
    <!--Grid row-->

    <hr>
    <!-- Classic tabs -->
<div class="classic-tabs border rounded px-4 pt-1">

  <ul class="nav tabs-default nav-justified" id="advancedTab" role="tablist">
    <li >
      <a class="nav-link active show" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">Comentarios del producto</a>
    </li>
  </ul>
 <div th:each="com:${comentarios}" class="tab-content" id="advancedTabContent">
    
    <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
      
    <span class="small text-muted text-uppercase">Cliente: [[${com.clientes.nombre}]]</span>
		<p class="small text-muted text-uppercase my-2">Comentario publicado el: [[${#dates.format(com.fechacreacion,'dd-MMM-yyyy')}]]</p>
	
      <p class="small text-muted text-uppercase my-2">[[${com.comentario}]]</p>
    </div>
          
    <hr>
    
  </div>

</div>
<hr>
    <div class="row d-flex justify-content-center wow fadeIn">


    </div>

    <div class="row wow fadeIn">

      <div class="col-lg-4 col-md-12 mb-4" th:each="obras:${ObrasRel}">

  <!-- Card -->
		  <div class="card mb-4">
		
		    <!--Card image-->
		    <div class="view overlay">
		      <img class="card-img-top" width="250%" height="234%" th:if="${#strings.length(obras.rutaimagen_principal)>0}" th:src="@{'/imagenes/'+${obras.rutaimagen_principal}}"
		        alt="Card image cap">
		      
		    </div>
		
		    <!--Card content-->
		    <div class="card-body">
		
		      <!--Title-->
		      <h4 class="card-title text-center"  th:text="${obras.nombre}"></h4>
		      <!--Text-->
		      <p class="card-text">[[${obras.descripcion}]]</p>
		      <!-- Provides extra visual weight and identifies the primary action in a set of buttons -->
		      <a href="Detalle.html"  class="btn btn-default  btn-block">!Lo Quiero</a>
		
		    </div>
		
		  </div>

      </div>


    </div>


  </div>
</main>


<!--Footer-->
<footer class="page-footer font-small unique-color-dark">

  

  <!-- Footer Links -->
  <div class="container text-center text-md-left mt-5">

    <!-- Grid row -->
    <div class="row mt-3">

      <!-- Grid column -->
      <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">

        <!-- Content -->
        <h6 class="text-uppercase font-weight-bold">Nombre Empresa</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>Art Academy</p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">Productos</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>
          <a href="#!">MDBootstrap</a>
        </p>
        <p>
          <a href="#!">MDWordPress</a>
        </p>
        <p>
          <a href="#!">BrandFlow</a>
        </p>
        <p>
          <a href="#!">Bootstrap Angular</a>
        </p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">ENLACES ÃšTILES
        </h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>
          <a href="#!">Your Account</a>
        </p>
        <p>
          <a href="#!">Become an Affiliate</a>
        </p>
        <p>
          <a href="#!">Shipping Rates</a>
        </p>
        <p>
          <a href="#!">Help</a>
        </p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">Contacto</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>
          <i class="fas fa-home mr-3"></i> New York, NY 10012, US</p>
        <p>
          <i class="fas fa-envelope mr-3"></i> info@example.com</p>
        <p>
          <i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
        <p>
          <i class="fas fa-print mr-3"></i> + 01 234 567 89</p>

      </div>
      <!-- Grid column -->

    </div>
    <!-- Grid row -->

  </div>
  <!-- Footer Links -->

  <!-- Copyright -->
  <div class="footer-copyright text-center py-3">Â© 2020 Copyright:
    <a href="#"> ArtAcademy</a>
  </div>
  <!-- Copyright -->

</footer>
<!-- Footer -->   

<!--/.Footer-->
<script>
  function alerta(){
    swal({
  title: "Bien!",
  text: "Tu Producto se anadiÃ³ al carrito!",
  icon: "success",
  button: "Ir al carrito!",
}).then(function(){
  window.location.href='carrito.html';
} );
  }
</script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script th:src="@{/frontend/js/jquery-3.4.1.min.js}"> </script>
<script th:src="@{/frontend/js/md-pro.js}"> </script>
<script th:src="@{/frontend/js/mdb.ecommerce.min.js}"> </script>
<script th:src="@{/frontend/js/mdb.min.js}"> </script>
<script th:src="@{/frontend/js/popper.min.js}"> </script>
<script th:src="@{/frontend/js/bootstrap.min.js}"> </script>
	<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.js"></script>
<script>
$(function(){
	$('form[id="formdetalle"]').validate({
		rules:{
			caracteristica: 'required'
			
		},
	 messages:{
		 caracteristica: 'Por favor seleccione un tamaño'
	},
	submitHandler : function(form){
		form.submit();
	}
	});
	
});
	var cantidad = 0;
	function buscar_caracteristica(e){
		let id = $(e).val();
		$.ajax({
			url: '/obtener_precio_cantidad/'+id,
			type: 'get',
			dataType: 'json'
		}).done(respuesta => {
			$("#precio").text(`Precio : ${respuesta.precio}`);
			cantidad = respuesta.stock;
		})
	}
	
	function validad_stock(){
		let valor = $("#txtCantidad").val();
		if(valor > cantidad){
			$("#btnGuardar").attr("disabled", true);
		}else{
			$("#btnGuardar").removeAttr("disabled");
		}
	}

</script>
</body>
</html>